# 11-02-microservices-principal

# Задача 1: API Gateway

|         | Azure API Managment | Amazon API Gateway | nginx |
|:------------- |:-------------| :-------------| :-------------| 
| Маршрутизация на основе конфигурации |Да|Да|Да|
| Авторизации на шлюзе |Да|Да |Да|
| Терминация HTTPS |Да|Да |Да|
| Cloud/on-permise |Cloud|Cloud |on-permise|
| геораспределённость  |Да|Да | Нужно самостоятельно разворачивать в разных ДЦ|

Учитывая, что все шлюзы соответсвуют требованиям, будем исходить из того, что мы не имеем своих ДЦ по всему миру и нам необходимо обеспечить минимальный отклик.
В таком случае разумным выбором являются облачные шлюзы Amazon, т.к. имеют несколько ДЦ по всему миру и де-факто являются стандартом в отралси. Так же мы сможем на этапе разработки использовать их бесплатно, т.к. до порогового значения нагрузок в месяц сервис предоставляется бесплатно

Если говорить о российской компании, то более целеесообразно использовать Yandex API Gateway или разворачивать nginx и продукты на его базе в разных регионах страны, например, на базе облака МТС. 

# Задача 2: Брокер сообщений

|         | RabbitMQ (AMQP) | Apache Kafka|  |
|:------------- |:-------------| :-------------| :-------------| 
| Кластеризация |Да|Да|
| Хранение сообщений на диске |Удлаяются после доставки| Удлаяются после таймаута|
| Высокая скорость |50К/s|1M/s |
| Поддержка различных форматов сообщений |Да, через плагины| Да, через API Языков программирования|
| Разделение прав доступа к потокам  |Да|Да | 
| Простота эксплуатации  |«умный сервер, тупой клиент»|«тупой сервер, умный клиент» | 

Если брать во внимание, что нужны высокая скорость обработки сообщений и простота эксплуатации, то выбором будет Kafka: можем восстановить сообщения за настроенный на сервере период , программисты сами в большей степени определяют логику работы с брокером, что даёт возможность менять логику работы в клиентской части приложения. 
